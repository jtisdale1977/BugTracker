@using BugTracker.Helpers;
@using BugTracker.Models;
@model IndexVM


<!DOCTYPE html>
<!--[if IE 9 ]><html class="ie9"><![endif]-->
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta name="format-detection" content="telephone=no">
    <meta charset="UTF-8">
    <meta name="description" content="Violate Responsive Admin Template">
    <meta name="keywords" content="Super Admin, Admin, Template, Bootstrap">
    <title>Bug Bomber</title>

    <!-- CSS -->
    <link href="~/Content/DataTables/css" rel="stylesheet" type="text/css">
    <link href="~/Content/DataTables/css/dataTables.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables/css/buttons.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables/css/autoFill.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables/css/colReorder.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables/css/select.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables/css/scroller.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables/css/rowReorder.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables/css/responsive.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables/css/keyTable.bootstrap.css" rel="stylesheet" />
    <link href="~/css/bootstrap.min.css" rel="stylesheet">
    <link href="~/css/animate.min.css" rel="stylesheet">
    <link href="~/css/font-awesome.min.css" rel="stylesheet">
    <link href="~/css/form.css" rel="stylesheet">
    <link href="~/css/calendar.css" rel="stylesheet">
    <link href="~/css/style.css" rel="stylesheet">
    <link href="~/css/icons.css" rel="stylesheet">
    <link href="~/css/generics.css" rel="stylesheet">
</head>
<body id="skin-blur-blue">
    <header id="header" class="media">
        <a href="" id="menu-toggle"></a>
        <a class="logo pull-left" href="index.html">BUG BOMBER</a>

        <div class="media-body">
            <div class="media" id="top-menu">
                <div class="pull-left tm-icon">
                    <a data-drawer="messages" class="drawer-toggle" href="">
                        <i class="sa-top-message"></i>
                        <i class="n-count animated">@Html.DisplayFor(model => model.TicketNotifications.Count)</i>
                        <span>Notifications</span>
                    </a>
                </div>
                @*<div class="pull-left tm-icon">
                        <a data-drawer="notifications" class="drawer-toggle" href="">
                            <i class="sa-top-updates"></i>
                            <i class="n-count animated">@Html.DisplayFor(model => model.TicketComments.Count)</i>
                            <span>Comments</span>
                        </a>
                    </div>*@

                <div id="time" class="pull-right">
                    <span id="hours"></span>
                    :
                    <span id="min"></span>
                    :
                    <span id="sec"></span>
                </div>

                <div class="media-body">
                    <input type="text" class="main-search">
                </div>
            </div>
        </div>
    </header>

    <div class="clearfix"></div>

    <section id="main" class="p-relative" role="main">

        <!-- Sidebar -->
        <aside id="sidebar">

            <!-- Sidbar Widgets -->
            <div class="side-widgets overflow">
                <!-- Profile Menu -->
                <div class="text-center s-widget m-b-25 dropdown" id="profile-menu">
                    <a href="" data-toggle="dropdown">
                        <img class="profile-pic animated" src="~/img/Bug_Bomb.jpg" alt="">
                    </a>
                    <ul class="dropdown-menu profile-menu">
                        <li><a href="">My Profile</a> <i class="icon left">&#61903;</i><i class="icon right">&#61815;</i></li>
                        <li><a href="">Change Password</a> <i class="icon left">&#61903;</i><i class="icon right">&#61815;</i></li>
                        <li><a href="">External Logins</a> <i class="icon left">&#61903;</i><i class="icon right">&#61815;</i></li>
                        <li><a href="">Sign Out</a> <i class="icon left">&#61903;</i><i class="icon right">&#61815;</i></li>
                    </ul>
                    <h4 class="m-0" id="log">@Html.Partial("_LoginPartial")</h4>
                </div>

                <!-- Calendar -->
                <div class="s-widget m-b-25">
                    <div id="sidebar-calendar"></div>
                </div>

                <hr class="whiter" />

                <!-- #region Projects Chart -->
                @*<div class="s-widget m-b-25">
                        <h2 class="tile-title">
                            Projects on going
                        </h2>

                        <div class="s-widget-body">
                            <div class="side-border">
                                <small>Joomla Website</small>
                                <div class="progress progress-small">
                                    <a href="#" data-toggle="tooltip" title="" class="progress-bar tooltips progress-bar-danger" style="width: 60%;" data-original-title="60%">
                                        <span class="sr-only">60% Complete</span>
                                    </a>
                                </div>
                            </div>
                            <div class="side-border">
                                <small>Opencart E-Commerce Website</small>
                                <div class="progress progress-small">
                                    <a href="#" data-toggle="tooltip" title="" class="tooltips progress-bar progress-bar-info" style="width: 43%;" data-original-title="43%">
                                        <span class="sr-only">43% Complete</span>
                                    </a>
                                </div>
                            </div>
                            <div class="side-border">
                                <small>Social Media API</small>
                                <div class="progress progress-small">
                                    <a href="#" data-toggle="tooltip" title="" class="tooltips progress-bar progress-bar-warning" style="width: 81%;" data-original-title="81%">
                                        <span class="sr-only">81% Complete</span>
                                    </a>
                                </div>
                            </div>
                            <div class="side-border">
                                <small>VB.Net Software Package</small>
                                <div class="progress progress-small">
                                    <a href="#" data-toggle="tooltip" title="" class="tooltips progress-bar progress-bar-success" style="width: 10%;" data-original-title="10%">
                                        <span class="sr-only">10% Complete</span>
                                    </a>
                                </div>
                            </div>
                            <div class="side-border">
                                <small>Chrome Extension</small>
                                <div class="progress progress-small">
                                    <a href="#" data-toggle="tooltip" title="" class="tooltips progress-bar progress-bar-success" style="width: 95%;" data-original-title="95%">
                                        <span class="sr-only">95% Complete</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>*@
                <!-- #endregion Projects Chart -->
            </div>

            <!-- Side Menu -->
            <ul class="list-unstyled side-menu">
                <li class="active">
                    <a class="sa-side-home" href="@Url.Action("Index")">
                        <span class="menu-item">Dashboard</span>
                    </a>
                </li>
                @if (User.IsInRole("Admin"))
                {
                <li>
                    <a class="sa-side-folder" href="@Url.Action("ListRoles", "Admin")">
                        <span class="menu-item">Member Management</span>
                    </a>
                </li>
                }
                @if (User.IsInRole("Admin") || User.IsInRole("Project Manager"))
                {
                <li>
                    <a class="sa-side-chart" href="@Url.Action("Create", "Projects")">
                        <span class="menu-item">Create New Project</span>
                    </a>
                </li>
                }
                @if (User.IsInRole("Admin"))
                {
                <li>
                    <a class="sa-side-typography" href="@Url.Action("Index", "Tickets")">
                        <span class="menu-item">System Tickets</span>
                    </a>
                </li>
                }
                @if (User.IsInRole("Project Manager") || User.IsInRole("Developer") || User.IsInRole("Submitter"))
                {
                <li>
                    <a class="sa-side-typography" href="@Url.Action("Index", "Tickets")">
                        <span class="menu-item">My Tickets</span>
                    </a>
                </li>
                }
                <li class="dropdown">
                    <a class="sa-side-page" href="">
                        <span class="menu-item">Portfolio</span>
                    </a>
                    <ul class="list-unstyled menu-item">
                        <li><a href="http://jtisdale-portfolio.azurewebsites.net/" target="blank">Justin Tisdale</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="sa-side-photos" href="">
                        <span class="menu-item">Shopping</span>
                    </a>
                    <ul class="list-unstyled menu-item">
                        <li><a href="http://jtisdale-shoppingcart.azurewebsites.net/" target="blank">Hardened Concepts</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="sa-side-form" href="">
                        <span class="menu-item">Blog</span>
                    </a>
                    <ul class="list-unstyled menu-item">
                        <li><a href="http://jtisdale-blog.azurewebsites.net/" target="blank">Tiz' BlogStar</a></li>
                    </ul>
                </li>
            </ul>
        </aside>

        <!-- Content -->
        <section id="content" class="container">

            <!-- Notification Drawer -->
            <div id="messages" class="tile drawer animated">
                <div class="listview narrow">
                    <div class="media">
                        <a href="">Notification(s) Index</a>
                        <span class="drawer-close">&times;</span>

                    </div>
                    <div class="overflow" style="height: 254px">
                        @{var nh = new NotificationsHelper();
                            foreach (var note in Model.TicketNotifications)
                            {
                        <div class="media">
                            <div class="media-body">
                                <small class="text-muted">@note.GeneratedDate</small><br>
                                <a class="t-overflow" href="">@note.User.FirstName, you have been assigned to ticket: @note.Ticket.Title @Html.Raw(note.Detail)</a>
                            </div>
                        </div>
                                }
                        }
                    </div>
                    <div class="media text-center whiter l-100">
                        <a href="@Url.Action("Index", "TicketNotifications")"><small>VIEW ALL</small></a>
                    </div>
                </div>
            </div>

            <!-- Breadcrumb -->
            <ol class="breadcrumb hidden-xs">
                <li><a href="javascript:void(0);">Home</a></li>
                <li><a href="@Url.Action("Index", "Projects")">Projects</a></li>
                <li class="active"><a href="@Url.Action("Index", "Tickets")">Tickets</a></li>
            </ol>

            <h4 class="page-title">DASHBOARD</h4>

            <hr class="whiter" />

            <!-- Quick Stats -->
            <div class="block-area">
                <div class="row">
                    <div class="col-md-3 col-xs-6">
                        <div class="tile quick-stats">
                            <div id="stats-line-2" class="pull-left"></div>
                            <div class="data">
                                <h2 data-value="@Html.DisplayFor(model => model.Projects.Count)">0</h2>
                                <small>Projects</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-xs-6">
                        <div class="tile quick-stats media">
                            <div id="stats-line-3" class="pull-left"></div>
                            <div class="media-body">
                                <h2 data-value="@Html.DisplayFor(model => model.Tickets.Count)">0</h2>
                                <small>Tickets</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-xs-6">
                        <div class="tile quick-stats media">
                            <div id="stats-line-4" class="pull-left"></div>
                            <div class="media-body">
                                <h2 data-value="@Html.DisplayFor(model => model.TicketComments.Count)">0</h2>
                                <small>Ticket Comments</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-xs-6">
                        <div class="tile quick-stats media">
                            <div id="stats-line" class="pull-left"></div>
                            <div class="media-body">
                                <h2 data-value="@Html.DisplayFor(model => model.TicketNotifications.Count)">0</h2>
                                <small>Notifications</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <hr class="whiter" />

            <!-- Projects Table -->
            <div class="block-area" id="tableStriped">
                @if (User.IsInRole("Admin") || User.IsInRole("Project Manager"))
                {
                    <h3 class="block-title">System Projects</h3>
                }
                else
                {
                    <h3 class="block-title">My Projects</h3>
                }
                <div class="table-responsive overflow">
                    <table class="tile table table-bordered table-striped" id="myTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Description</th>
                                <th>Members</th>
                                <th>Tickets Open</th>
                                <th>Tickets Assigned</th>
                                <th>Tickets Closed</th>
                                <th>Ticket History</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{var ph = new ProjectHelper();
                                foreach (var proj in Model.Projects)
                                {
                                    <tr>
                                        <td>@proj.Name</td>
                                        <td>@Html.Raw(proj.Description)</td>
                                        <td>
                                            @foreach (var user in ph.UserOnProject(proj.Id))
                                            {
                                                @user.DisplayName <br />
                                            }
                                        </td>
                                        <td>@Html.DisplayFor(modelItem => proj.Ticket.Count)</td>
                                        <td>@Html.DisplayFor(modelItem => proj.Ticket.Count)</td>
                                        <td>@Html.DisplayFor(modelItem => proj.Ticket.Count)</td>
                                        <td>@Html.DisplayFor(modelItem => proj.Ticket.Count)</td>
                                        <td id="itd">

                                            <div class="btn-group-vertical m-r-10">
                                                @if (User.IsInRole("Submitter"))
                                                {
                                                    <button id="NT" type="button" class="btn btn-xs btn-alt">@Html.ActionLink("New Ticket", "Create", "Tickets", new { id = proj.Id }, null)</button>
                                                }

                                                <button id="MT" type="button" class="btn btn-xs btn-alt">@Html.ActionLink("My Tickets", "Index", "Tickets", new { id = proj.Id }, null)</button>

                                                @if (User.IsInRole("Admin") || User.IsInRole("Project Manager"))
                                                {
                                                    <button id="AU" type="button" class="btn btn-xs btn-alt">@Html.ActionLink("Assign User", "ProjectAssign", "Projects", new { id = proj.Id }, null)</button>
                                                }

                                                <button id="DT" type="button" class="btn btn-xs btn-alt">@Html.ActionLink("Details", "Details", "Projects", new { id = proj.Id }, null)</button>

                                                @if (User.IsInRole("Admin") || User.IsInRole("Project Manager"))
                                                {
                                                    <button id="ED" type="button" class="btn btn-xs btn-alt">@Html.ActionLink("Edit", "Edit", "Projects", new { id = proj.Id }, null)</button>

                                                    <button id="DL" type="button" class="btn btn-sm btn-alt">@Html.ActionLink("Delete", "Delete", "Projects", new { id = proj.Id }, null)</button>
                                                }
                                            </div>
                                        </td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                    <br />
                </div>
            </div>

            <hr class="whiter" />

            @if (User.IsInRole("Admin") || User.IsInRole("Project Manager"))
            {
            <!--My Projects Table-->
                <div class="block-area" id="tableStriped">
                    <h3 class="block-title">System Tickets</h3>
                    <div class="table-responsive overflow">
                        <table class="tile table table-bordered table-striped" id="myTable2">
                            <thead>
                                <tr>
                                    <th>Id</th>
                                    <th>Title</th>
                                    <th>Description</th>
                                    <th>Project Name</th>
                                    <th>Priority</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var ticket in Model.Tickets)
                                {
                                    <tr>
                                        <td>@Html.DisplayFor(modelItem => ticket.Id)</td>
                                        <td>@Html.DisplayFor(modelItem => ticket.Title)</td>
                                        <td>@Html.Raw(ticket.Description)</td>
                                        <td>@Html.DisplayFor(modelItem => ticket.Project.Name)</td>
                                        <td>@Html.DisplayFor(modelItem => ticket.TicketPriority.Name)</td>
                                        <td>@Html.DisplayFor(modelItem => ticket.TicketType.Name)</td>
                                        <td>@Html.DisplayFor(modelItem => ticket.TicketStatus.Name)</td>
                                        <td id="itd2">
                                            <div class="btn-group-vertical m-r-10">

                                                <button id="DT" type="button" class="btn btn-xs btn-alt">@Html.ActionLink("Details", "Details", "Tickets", new { id = ticket.Id }, null)</button>

                                                <button id="ED" type="button" class="btn btn-xs btn-alt">@Html.ActionLink("Edit", "Edit", "Tickets", new { id = ticket.Id }, null)</button>

                                                <button id="DL" type="button" class="btn btn-xs btn-alt">@Html.ActionLink("Delete", "Delete", "Tickets", new { id = ticket.Id }, null)</button>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            }
        </section>

        <!--#region Older IE Message -->
        <!--[if lt IE 9]>
            <div class="ie-block">
                <h1 class="Ops">Ooops!</h1>
                <p>You are using an outdated version of Internet Explorer, upgrade to any of the following web browser in order to access the maximum functionality of this website. </p>
                <ul class="browsers">
                    <li>
                        <a href="https://www.google.com/intl/en/chrome/browser/">
                            <img src="img/browsers/chrome.png" alt="">
                            <div>Google Chrome</div>
                        </a>
                    </li>
                    <li>
                        <a href="http://www.mozilla.org/en-US/firefox/new/">
                            <img src="img/browsers/firefox.png" alt="">
                            <div>Mozilla Firefox</div>
                        </a>
                    </li>
                    <li>
                        <a href="http://www.opera.com/computer/windows">
                            <img src="img/browsers/opera.png" alt="">
                            <div>Opera</div>
                        </a>
                    </li>
                    <li>
                        <a href="http://safari.en.softonic.com/">
                            <img src="img/browsers/safari.png" alt="">
                            <div>Safari</div>
                        </a>
                    </li>
                    <li>
                        <a href="http://windows.microsoft.com/en-us/internet-explorer/downloads/ie-10/worldwide-languages">
                            <img src="img/browsers/ie.png" alt="">
                            <div>Internet Explorer(New)</div>
                        </a>
                    </li>
                </ul>
                <p>Upgrade your browser for a Safer and Faster web experience. <br/>Thank you for your patience...</p>
            </div>
        <![endif]-->
        <!--#endregion Older IE Message -->

    </section>

    <!-- Javascript Libraries -->
    <!-- jQuery -->
    <script src="~/js/jquery.min.js"></script> <!-- jQuery Library -->
    <script src="~/js/jquery-ui.min.js"></script> <!-- jQuery UI -->
    <script src="~/js/jquery.easing.1.3.js"></script> <!-- jQuery Easing - Requirred for Lightbox + Pie Charts-->
    <!-- Bootstrap -->
    <script src="~/js/bootstrap.min.js"></script>
    <!-- Charts -->
    <script src="~/js/charts/jquery.flot.js"></script> <!-- Flot Main -->
    <script src="~/js/charts/jquery.flot.time.js"></script> <!-- Flot sub -->
    <script src="~/js/charts/jquery.flot.animator.min.js"></script> <!-- Flot sub -->
    <script src="~/js/charts/jquery.flot.resize.min.js"></script> <!-- Flot sub - for repaint when resizing the screen -->
    <script src="~/js/sparkline.min.js"></script> <!-- Sparkline - Tiny charts -->
    <script src="~/js/easypiechart.js"></script> <!-- EasyPieChart - Animated Pie Charts -->
    <script src="~/js/charts.js"></script> <!-- All the above chart related functions -->
    <!-- Map -->
    <script src="~/js/maps/jvectormap.min.js"></script> <!-- jVectorMap main library -->
    <script src="~/js/maps/usa.js"></script> <!-- USA Map for jVectorMap -->
    <!--  Form Related -->
    <script src="~/js/icheck.js"></script> <!-- Custom Checkbox + Radio -->
    <!-- UX -->
    <script src="~/js/scroll.min.js"></script> <!-- Custom Scrollbar -->
    <!-- Other -->
    <script src="~/js/calendar.min.js"></script> <!-- Calendar -->
    <script src="~/js/feeds.min.js"></script> <!-- News Feeds -->
    <!-- All JS functions -->
    <script src="~/Scripts/DataTables/jquery.dataTables.js"></script>
    <script src="~/Scripts/DataTables/dataTables.bootstrap.js"></script>
    <script src="~/js/functions.js"></script>
    <script type="text/javascript" charset="utf8" src="~/Scripts/DataTables.js"></script>
    <script type="text/javascript" src="//cdn.datatables.net/1.10.6/js/jquery.dataTables.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#myTable").DataTable();
        });
    </script>
    <script>
        $(document).ready(function () {
            $('#myTable2').DataTable();
        });
    </script>
</body>
</html>
